trading:
  paper_mode: true
  total_capital: 60000
  timezone: "America/New_York"

data:
  provider: "alpaca"
  feed: "iex"  # or "sip"
  cycle_interval_seconds: 300  # 5 min for IEX

broker:
  provider: "ibkr"            # "alpaca" or "ibkr"
  ibkr:
    host: "127.0.0.1"           # TWS/Gateway host
    port: 7497                   # 7497=TWS paper, 7496=TWS live, 4002=Gateway paper, 4001=Gateway live
    client_id: 117               # Use unique IDs for multiple bots
    timeout: 30                  # Connection timeout seconds
    readonly: false              # True = data-only mode (no orders)
    account: ""                  # Empty = default account
    max_reconnect_attempts: 5
    reconnect_delay_seconds: 10

risk:
  max_daily_loss_pct: 2.0
  max_drawdown_pct: 8.0
  max_gross_exposure_pct: 80.0
  max_single_position_pct: 5.0
  max_correlated_positions: 3
  strategy_daily_loss_limit_pct: 1.0

execution:
  broker: "alpaca"
  max_spread_pct: 0.3
  use_marketable_limits: true

logging:
  level: "INFO"
  file: "data/logs/algotrader.log"
  json_format: true

alerts:
  enabled: true
  big_win_threshold: 500.0
  big_loss_threshold: -300.0
  webhook_url: ""               # Set for Telegram/Slack/Discord
  alert_file: "data/logs/alerts.log"

strategy_selector:
  enabled: true
  mode: "brain"                 # "brain" (new) or "classic" (legacy)
  regime_config: "config/regimes.yaml"

  # Brain-specific config (used when mode = "brain")
  brain:
    min_confidence: 0.60
    min_risk_reward: 1.5
    min_edge_pct: 0.3
    options_min_confidence: 0.55
    options_min_risk_reward: 0.3
    options_min_edge_pct: 0.1
    max_daily_trades: 5
    max_capital_per_trade_pct: 20.0
    max_daily_risk_pct: 2.0
    cash_is_default: true
    regime_mismatch_penalty: 0.5
    correlation_penalty: 0.3
    recent_loss_cooldown_hours: 4
    midday_confidence_multiplier: 1.2
    midday_pnl_stop_pct: -1.0

  # Classic mode config (used when mode = "classic")
  min_activation_score: 0.35
  review_hour: 12              # Noon ET
  review_minute: 0
  min_allocation_pct: 3.0
  max_total_deployment_pct: 80.0
  cash_threshold: 0.25
  max_single_strategy_pct: 70.0
  concentration_power: 2.0
  scale_down_threshold_pct: -0.5
  disable_threshold_pct: -0.8
  scale_up_threshold_pct: 0.3
  scale_up_factor: 1.25
  scale_down_factor: 0.5
  min_trades_for_review: 2

# Strategy configs can also be loaded from config/strategies/<name>.yaml
# Total allocation = 95%. Strategies won't all be active simultaneously
# (regime filtering). Actual deployed capital at any time should be 50-80%.
strategies:
  pairs_trading:
    enabled: true
    capital_allocation_pct: 25.0
    max_positions: 5
    params:
      lookback_bars: 252
      z_entry_threshold: 2.0
      z_exit_threshold: 0.2
      z_stop_threshold: 2.8
      max_bars_in_position: 80
      min_correlation: 0.7
      cointegration_pvalue: 0.05
      per_pair_capital_pct: 2.0
      max_simultaneous_pairs: 5
      bar_timeframe: "5Min"

  gap_reversal:
    enabled: true
    capital_allocation_pct: 12.0
    max_positions: 3
    params: {}  # Uses defaults from strategy or config/strategies/gap_reversal.yaml

  momentum:
    enabled: true
    capital_allocation_pct: 15.0
    max_positions: 4
    params: {}

  vwap_reversion:
    enabled: true
    capital_allocation_pct: 10.0
    max_positions: 3
    params: {}

  options_premium:
    enabled: true
    capital_allocation_pct: 15.0
    max_positions: 3
    params: {}

  sector_rotation:
    enabled: true
    capital_allocation_pct: 10.0
    max_positions: 4
    params: {}

  event_driven:
    enabled: true
    capital_allocation_pct: 8.0
    max_positions: 2
    params: {}
